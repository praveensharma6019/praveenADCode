@using Sitecore.Feature.Navigation
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Mvc.Presentation
@using Sitecore.Data.Fields
@using Sitecore.Data.Items
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@model Sitecore.Mvc.Presentation.RenderingModel
@{
    var datasource = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.DataSource;
    Item elements = Sitecore.Context.Database.GetItem(datasource);
    var Dataitem = elements.Children.OrderByDescending(x => x.Fields["Date"].Value);

    Sitecore.Data.Fields.ImageField thumbnail = ((Sitecore.Data.Fields.ImageField)elements.Fields["__Thumbnail"]);
    var thumbimg = Sitecore.Resources.Media.MediaManager.GetMediaUrl(thumbnail.MediaItem);

    var count = 0;
    var itemslinks = "";
    var cnt = 0;

}
<section class="capabilities d-block position-relative">
    <div class="container">
        <div class="section-title">
            @if (Sitecore.Context.Item.TemplateName != "Home")
            {
                <h1>@Html.Sitecore().Field("Title", elements)</h1>
            }
            else
            {
                <h1>News and updates</h1>
            }
        </div>
        <p class="py-4"><p class="py-4">@Html.Sitecore().Field("Description", elements)</p></p>
        <div class="news-box-3 show-more-height-3">
            <div class="row">
                @foreach (var data in Dataitem)
                {
                    Sitecore.Data.Fields.ImageField ImageField = ((Sitecore.Data.Fields.ImageField)data.Fields["Image"]);
                    count++;

                    Sitecore.Data.Fields.LinkField itemslinkvalues = data.Fields["RedirectURL"];
                    itemslinks = itemslinkvalues.GetFriendlyUrl();
                    <div class="col-lg-3 py-3">
                        <a href=@itemslinks target="_blank">
                            <div class="new-box news-box-1">
                                <div class="news-box-img position-relative">
                                    @if (ImageField.MediaItem != null && ImageField.MediaItem.ToString() != "")
                                    {
                                        var imgurl = Sitecore.Resources.Media.MediaManager.GetMediaUrl(ImageField.MediaItem);
                                        <img src=@imgurl alt="news" class="img-fluid">
                                    }
                                    else
                                    {
                                        <img src=@thumbimg alt="news" class="img-fluid">
                                    }
                                    @if (!string.IsNullOrEmpty(Html.Sitecore().Field("MediaType", data).ToString()))
                                    {
                                        <div class="news-bottom">

                                            <p>
                                                @Html.Sitecore().Field("MediaType", data)
                                            </p>


                                        </div>
                                    }

                                </div>

                                <div class="news-text pt-5">

                                    <p>@Html.Sitecore().Field("Date", data, new { format = "yyyy" })</p>

                                    @*@itemDate*@
                                    <h4>@Html.Sitecore().Field("Title", data)</h4>
                                </div>
                            </div>
                        </a>
                    </div>
                    cnt++;

                }

            </div>
        </div>
    </div>


    @if (count > 4)
    {
        <div class="explore-btn py-5">
            <a class="explore--open-3">@Html.Sitecore().Field("ButtonClass", elements)</a>
        </div>
    }
    </div>
</section>

