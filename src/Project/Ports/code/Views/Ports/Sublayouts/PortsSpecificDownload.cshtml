@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Foundation.Dictionary.Repositories
@using Sitecore.Mvc.Presentation
@using System.Text.RegularExpressions
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Data
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Resources.Media;
@using Sitecore.Data.Items;
@using Sitecore
@using Sitecore.Data.Fields

@model RenderingModel
@{
    var datasource = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.DataSource;
    var parent = Sitecore.Context.Database.GetItem(datasource);
    var containerId = Regex.Replace(@Html.Sitecore().Field("Heading").ToString().ToString(), "[^a-zA-Z0-9_]+", "").ToLower();
    var energycalculator = DictionaryPhraseRepository.Current.Get("/More Services For You/Energy Calculator/Energy Calculator", "Energy Calculator");
    var PageTitle = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.Parameters["PageTitle"];
}




<section class="py-5 text-center bg-gray">
    <div class="container">
        <h1 class="txt-md font-weight-500">@PageTitle</h1>
    </div>
</section>
<section class="bg-gray pb-5">
    @foreach (var child in parent.Children.ToList())
    {
        LinkField URL = child.Fields["Link"];
        if (URL.TargetItem != null)
        {
            var item = URL.TargetItem;

            <div class="container mt-4">
                <h2 class="heading pl-4 mb-4">@child.Name</h2>
                <div class="row">
                    @foreach (var docs in item.Children.ToList())
                    {
                        var theURL = Sitecore.Resources.Media.MediaManager.GetMediaUrl(docs);
                        var url = Sitecore.Resources.Media.HashingUtils.ProtectAssetUrl(theURL);

                        <div class="col-md-4 mb-4">
                            <a href="@url">
							<div class="tariff-block bg-white border p-4">
                                <p>@docs.Name</p>
                            </div>
							</a>
                        </div>
                    }

                </div>
            </div>
        }
    }
</section>

