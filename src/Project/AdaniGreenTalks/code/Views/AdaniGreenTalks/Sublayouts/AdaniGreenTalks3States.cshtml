@using Sitecore
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Data.Fields
@using Sitecore.Data.Items
@using Sitecore.Foundation.Assets
@using Sitecore.Foundation.Assets.Models
@using Sitecore.Foundation.Assets.Services
@using Sitecore.ExperienceForms.Mvc.Html
@using Sitecore.Foundation.Dictionary.Extensions
@using Sitecore.Mvc
@using Sitecore.Mvc.Presentation 
@model Sitecore.Mvc.Presentation.RenderingModel
@{
   
	var datasource = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.DataSource;
    Item model = Sitecore.Context.Database.GetItem(datasource);
    string imgurl = "#";
    string altText = "";
    string btnUrl = "";
	int count = 1;
}

@if (model != null)
{
    if (model.HasChildren)
    {

        Sitecore.Data.Fields.LinkField linkField = model.Fields["ButtonLink"];
        if (linkField != null)
        {
            btnUrl = linkField.GetFriendlyUrl();
        }



<div class="participation-steps-section">
	<div class="container">
		<div class="top">
			<h2>@Html.Sitecore().Field("MediaTitle", model)</h2>
		</div>
		<div class="wrap">
			<span class="divider"></span>

@foreach (Item item in model.GetChildren())
                            {
								
                                Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)item.Fields["MediaThumbnail"]);
                                if (imgField != null && imgField.MediaItem != null)
                                {
                                    imgurl = Sitecore.Resources.Media.MediaManager.GetMediaUrl(imgField.MediaItem);
                                    altText = imgField.Alt;
                                }

					<div class="item">
						<div class="img">
							<span class="count-val">@count</span>
							<img src="@imgurl" alt="@altText" />
						</div>
						<div class="desc">
							<h3>@Html.Sitecore().Field("MediaTitle", item)</h3>
							<p>@Html.Sitecore().Field("MediaDescription", item)</p>
						</div>
					</div>
					count++;
                            }


		</div>
			 @if (!String.IsNullOrEmpty(btnUrl))
                        {

                            if (linkField.LinkType.ToLower() == "internal")
                            {
		<div class="green-button-section">
			<a href="@btnUrl" class="btn"> @Html.Sitecore().Field("ButtonTitle", model)</a>
		</div>
                            }
                            if (linkField.LinkType.ToLower() == "external")
                            {

		<div class="green-button-section">
			<a href="@btnUrl" target="_blank" class="btn"> @Html.Sitecore().Field("ButtonTitle", model)</a>
		</div>
                            }

                        }
                        else
                        {
		<div class="green-button-section">
			<a href="javascript:void(0)" class="btn"> @Html.Sitecore().Field("ButtonTitle", model)</a>
		</div>

                        }
	</div>
</div>
    }

}