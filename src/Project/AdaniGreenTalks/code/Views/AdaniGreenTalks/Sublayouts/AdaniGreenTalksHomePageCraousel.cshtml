@using Sitecore
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Data.Fields
@using Sitecore.Data.Items
@using Sitecore.Foundation.Assets
@using Sitecore.Foundation.Assets.Models
@using Sitecore.Foundation.Assets.Services
@using Sitecore.ExperienceForms.Mvc.Html
@using Sitecore.Foundation.Dictionary.Extensions
@using Sitecore.Mvc
@using Sitecore.AdaniGreenTalks.Website;
@model Sitecore.Mvc.Presentation.RenderingModel
@{
    var datasource = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.DataSource;
    Item model = Sitecore.Context.Database.GetItem(datasource);

    string imgurl = "#";
    string altText = "";
    string thumbimgurl = "#";
    string thumbaltText = "";
    string btnUrl = "#";
}

@if (model != null)
{
    if (model.HasChildren)
    {
        <div class="cm-home">
            <div class="carousel">
                @foreach (Item item in model.GetChildren())
                {
                    Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)item.Fields[Constant.MediaImage]);
                    if (imgField != null && imgField.MediaItem != null)
                    {
                        imgurl = Sitecore.Resources.Media.MediaManager.GetMediaUrl(imgField.MediaItem);
                        altText = imgField.Alt;
                    }

                    Sitecore.Data.Fields.ImageField thumbimgField = ((Sitecore.Data.Fields.ImageField)item.Fields[Constant.MediaThumbnail]);
                    if (thumbimgField != null && thumbimgField.MediaItem != null)
                    {
                        thumbimgurl = Sitecore.Resources.Media.MediaManager.GetMediaUrl(thumbimgField.MediaItem);
                        thumbaltText = thumbimgField.Alt;
                    }

                    Sitecore.Data.Fields.LinkField linkField = item.Fields[Constant.ButtonLink];
                    if (linkField != null)
                    {
                        btnUrl = linkField.GetFriendlyUrl();
                    }

                    <div class="slide-container">

                        @if (btnUrl != "#")
                        {
                            if (linkField.LinkType == "internal")
                            {

                                <a href="@btnUrl">

                                    <img src="@imgurl" alt="@altText" class="desk-img">
                                    <img src="@thumbimgurl" alt="@thumbaltText" class="mob-img">
                                    <div class="slider-content">
                                        <h3>
                                            <span>@Html.Sitecore().Field(Constant.MediaTitle, item) @Html.Sitecore().Field(Constant.SubTitle, item) </span>
                                        </h3>
                                        <p> @Html.Sitecore().Field(Constant.MediaDescription, item)</p>
                                        <span class="carousel-btn">@Html.Sitecore().Field(Constant.ButtonTitle, item)</span>
                                    </div>
                                </a>
                            }
                            if (linkField.LinkType == "external")
                            {
                                <a href="@btnUrl" target="_blank">
                                    <img src="@imgurl" alt="@altText" class="desk-img">
                                    <img src="@thumbimgurl" alt="@thumbaltText" class="mob-img">
                                    <div class="slider-content">
                                        <h3>
                                            <span>@Html.Sitecore().Field(Constant.MediaTitle, item) @Html.Sitecore().Field(Constant.SubTitle, item) </span>
                                        </h3>
                                        <p> @Html.Sitecore().Field(Constant.MediaDescription, item)</p>



                                        <span class="carousel-btn">@Html.Sitecore().Field(Constant.ButtonTitle, item)</span>
                                    </div>
                                </a>
                            }
                        }
                        else
                        {
                            <a href="javascript:void(0)">
                                <img src="@imgurl" alt="@altText" class="desk-img">
                                <img src="@thumbimgurl" alt="@thumbaltText" class="mob-img">
                                <div class="slider-content">
                                    <h3>
                                        <span>@Html.Sitecore().Field(Constant.MediaTitle, item) @Html.Sitecore().Field(Constant.SubTitle, item) </span>
                                    </h3>
                                    <p> @Html.Sitecore().Field(Constant.MediaDescription, item)</p>

                                    <span class="carousel-btn">@Html.Sitecore().Field(Constant.ButtonTitle, item)</span>
                                </div>
                            </a>
                        }
                    </div>
                }
            </div>
        </div>
    }
}