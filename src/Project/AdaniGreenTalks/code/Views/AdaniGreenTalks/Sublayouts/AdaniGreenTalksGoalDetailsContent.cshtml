@using Sitecore
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Data.Fields
@using Sitecore.Data.Items
@using Sitecore.Foundation.Assets
@using Sitecore.Foundation.Assets.Models
@using Sitecore.Foundation.Assets.Services
@using Sitecore.ExperienceForms.Mvc.Html
@using Sitecore.Foundation.Dictionary.Extensions
@using Sitecore.AdaniGreenTalks.Website;
@using Sitecore.Mvc
@model Sitecore.Mvc.Presentation.RenderingModel
@{

    string datasource = Sitecore.Mvc.Presentation.RenderingContext.Current.Rendering.DataSource;
    Item model = Sitecore.Context.Database.GetItem(datasource);
    string imgurl = "#";
    string altText = "";
}

@if (model != null)
{
    <div class="container">

        @foreach (Item item in model.GetChildren())
        {
            var HideReadMore = item.Fields["HideReadMore"].IsChecked();
            Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)item.Fields["Image"]);
            if (imgField != null && imgField.MediaItem != null)
            {
                imgurl = Sitecore.Resources.Media.MediaManager.GetMediaUrl(imgField.MediaItem);
                altText = imgField.Alt;
            }
            else
            {
                imgurl = "#";
                altText = "";
            }

            <div class="story-problemstatement @Html.Sitecore().Field("Toggle", item)" id='@Html.Sitecore().Field("ID", item)'>
                <div class="problem-desc">
                    <div class="heading">
                        <h2>@Html.Sitecore().Field("Title", item)</h2>
                        @Html.Sitecore().Field("Description", item)
                        @if (!HideReadMore)
                        {
                            <button type="button" class="about-btn">
                                <span class="more">Read More</span>
                                <span class="less" style="display: none;">Read Less</span>
                            </button>
                        }
                    </div>
                </div>
                <div class='problem-image'>
                    <img src="@imgurl" alt="@altText">
                </div>
            </div>
        }
    </div>
}
