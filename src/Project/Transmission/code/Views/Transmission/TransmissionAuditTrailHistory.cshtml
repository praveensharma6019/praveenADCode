@using Sitecore.Foundation.Dictionary.Extensions
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Mvc.Configuration
@model List<Sitecore.Transmission.Website.TransmissionInsertCostCalculator>

@{
    var count = 1;
}
@if (Session["Message"] != null && !string.IsNullOrEmpty(Session["Message"].ToString()))
{
    Session["showPresentCarbonFootprint"] = "false";
    Response.Redirect("/Carbon-Footprint-Calculator");

}

else
{
    using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { id = "frmNewConnectionApplicationList", @class = "form-signin", enctype = "multipart/form-data" }))
    {
        Session["showPresentCarbonFootprint"] = "true";
        @Html.AddUniqueFormId()
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true)
        <!-- Page Content -->
        <section class="section_calc">
            <div class="container">
                <div class="row mb-4">
                    <div class="col-lg-8">
                        <h1>Welcome, @Session["UserName"]</h1>
                        <h2>Your previous carbon calculations</h2>
                    </div>


                    <div class="col-lg-4">
                        <p class="btn-logout text-lg-right text-left mt-lg-0 mt-3">

                            <button id="logoutbtn" class="btn btn-primary">
                                <span class="fa fa-sign-out-alt mr-2" style="
"></span>Logout
                            </button>
                        </p>
                    </div>

                </div>

                <div class="table-responsive table-calc">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Sr. No</th>
                                <th style="width: 151px;">Submit Date</th>
                                <th>Consumption Month</th>
                                <th>Total Domestic Uses (Tonnes)</th>
                                <th>Total Transportation Uses (Tonnes)</th>
                                <th>Emission from Air Trips (Tonnes)</th>
                                <th>Total Carbon Emission(Tonnes)</th>
                                <th>Average Emission per Month per person (Tonnes)</th>
                                <th> Your Annual Carbon Footprint (Tonnes)</th>
                                <th>Estimated Annualized Carbon Value</th>
                                @*<th>Average Annual Carbon Footprint per person in India (Tonnes)</th>
                                    <th>Land Needed to plant trees for removing your carbon footprint  (Hectares)</th>
                                    <th>No.of Trees needed to remove Your Carbon Footprint</th>*@

                            </tr>
                        </thead>
                        <tbody>


                            @foreach (var app in Model)
                            {
                                <tr>
                                    <td>@count</td>
                                    <td>@Convert.ToDateTime(app.FormSubmitOn).ToString("dd-MM-yyyy")</td>
                                    <td>@(app.MonthName + " " + app.Year)</td>
                                    @*<td>@app.EmissionfromDomesticUse</td>*@
                                    <td>@Math.Round(Convert.ToDecimal(app.EmissionfromDomesticUse), 2)</td>
                                    @*<td>@app.EmissionfromTransportation</td>*@
                                    <td>@Math.Round(Convert.ToDecimal(app.EmissionfromTransportation), 2)</td>
                                    @*<td>@app.NumberofTrips</td>*@
                                    <td>@Math.Round(Convert.ToDecimal(app.NumberofTrips), 2)</td>
                                    <td>@Math.Round((Convert.ToDecimal(app.EmissionfromDomesticUse) + Convert.ToDecimal(app.EmissionfromTransportation) + Convert.ToDecimal(app.NumberofTrips)), 2)</td>

                                    @*<td>@app.AverageEmissionperMonth</td>*@
                                    <td>@Math.Round(Convert.ToDecimal(app.AverageEmissionperMonth), 2)</td>
                                    @*@{
                                            int annualfootprint= int.Parse(app.AnnualCarbonFootprint);
                                        }*@
                                    <td id="month_" + @count>@app.AnnualCarbonFootprint</td>
                                    <td>@app.EstimatedCarbonAnnualizedValue</td>
                                    @*<td>1.94</td>
                                        <td>@app.LandNeededtoPlantTrees</td>
                                        <td>@app.NumberofTreesNeeded</td>*@



                                </tr>
                                count = count + 1;
                            }

                        </tbody>
                    </table>
                </div>

                <div class="text-right">
                    <a href="/Carbon-Footprint-Calculator" class="btn btn-primary">Calculate</a>
                </div>
            </div>
        </section>

        if (Session["ReviewMessage"] != null && !string.IsNullOrEmpty(Session["ReviewMessage"].ToString()))
        {
            <div class="form-group row">
                <input id="ReviewMessage" type="hidden" value="@Session["ReviewMessage"].ToString()" />
            </div>

            <div id="message_modal" class="modal fade show" role="dialog" style="display: none; padding-right: 17px;" data-id="">
                <div class="modal-dialog modal-dialog-centered">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <p>Message</p>
                            <button type="button" class="close" data-dismiss="modal">X</button>
                        </div>
                        <div class="modal-body">
                            @if (Session["ReviewMessage"] != null && !string.IsNullOrEmpty(Session["ReviewMessage"].ToString()))
                            {
                                <div class="form-group row">
                                    <label for="" class="col-sm-12 col-form-label txt-green">@Session["ReviewMessage"].ToString()</label>
                                </div>
                                Session["ReviewMessage"] = null;
                                Session["AlertMessage"] = null;
                            }
                        </div>
                        <button type="button" style="padding-bottom:10px;" class="close" data-dismiss="modal">Ok</button>
                    </div>

                </div>
            </div>
        }

    }

}
