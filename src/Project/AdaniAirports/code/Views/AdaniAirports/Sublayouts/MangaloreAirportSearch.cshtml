@using Sitecore
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@model Sitecore.Mvc.Presentation.RenderingModel
@{
    /**/



  


}
<section class="mainSlider">
    <div class="">
        <div class="breadcrumb-sl-inner breadcrumb-sl-inner_contact">
            <div class="container-fluid">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li>Search Result</li>
                </ul>
            </div>
        </div>
    </div>
</section>
<section class="pt-5 pb-3 bg-white search-block">
<div class="container-fluid">
	<form class="form-inline d-flex justify-content-center md-form form-sm" onSubmit="return false;">
		<input class="form-control form-control-sm mr-3 SearchBox" type="text" placeholder="Search" aria-label="Search" id="SearchBox">
		<button class="btn waves-effect waves-light" type="button" onclick="Search()" value="X" id="SearchBtn"><i class="fas fa-search active" aria-hidden="true"></i></button>
	</form>
</div>
</section>

<section class="pb-5 bg-white content-header">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-9">
				<div class="search_history" id="search_history">
				
<h2 class="text-center txt-sm mb-0">No search result available</h2>               
             
				
				
				</div>
			</div>
			
		</div>
	</div>
</section>
<script src="/scripts/MangaloreAirport/jquery.min.js"></script>
<script>  
    $(document).ready(function () {
        var key = GetParameterValues('Key');
      function GetParameterValues(param) {
           var value;
           var url = window.location.href.slice(window.location.href.indexOf('?') + 1);
        if(url.indexOf('=')> 0){ value=  url.split('=')[1];  };
        return value;
        }
        if(key !== undefined)
        {
    $('#SearchBox').val(key)
    $('#SearchBtn').click();   
} 
  
    });
</script> 
<script>

   
  $('.SearchBox').keypress(function (event) {
       // event.preventDefault();
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if (keycode == '13') {
            $('#SearchBtn').click();// Search();
            event.preventDefault();
        }
       
    });
   

    function Search() {
      //  $('#SearchBtn').submit();
        var itemId = "";
	 if( $('.SearchBox').val() != "")
         itemId = $('.SearchBox').val();
		 else
		     itemId = $('#SearchBox').val();
			 
	 
        $.ajax({
            method: "POST",
            data: { itemId: itemId },
            url: "/api/MangaloreAirport/GetSearchResult",
            context: this,
            success: function (objects) {
                // alert("s1");
                console.log(objects);
                $('#search_history').html('');
                var html = "";

                for (var i = 0; i < objects.length; i++) {
                    var value = objects[i]["Value"];
                    if (value.indexOf("New Local Datasource Folder") > 0) {

                    }
					
                    else {
                        if (value.indexOf("MangaloreAirport/Home") > 0)
                            value = value.replace("/MangaloreAirport/Home/", "");

						if(!value.startsWith("/"))
									value = "/" + value;

                        html = html + '<div class="search_history_item">'+
						'<a href="' + value + '">'+
						
						'<h2>' + objects[i]["Key"] +
						'<p>' + objects[i]["Key"] +
						'</p>'+
						'</h2>'+
						'</a>'+
						'</div>';}
                }
if(objects.length ==0)
{
                        html = html + '<div class="search_history" id="search_history">' + 
'<h2 class="text-center txt-sm mb-0">' + 'No search result available' +'</h2>' +               
'</div>'

}
                $('#search_history').html(html);
                return false;
                
            }
        });
      
    }


    //$('#SearchBtn').on('submit', function (e) {
    //    alert("1");
    //    e.preventDefault();
    //    //  e.stopPropagation(); // only neccessary if something above is listening to the (default-)event too

    //    var itemId = $('#SearchBox').val();
    //    $.ajax({
    //        method: "POST",
    //        data: { itemId: itemId },
    //        url: "/api/MangaloreAirport/GetSearchResult",
    //        context: this,
    //        success: function (objects) {
    //            // alert("s1");
    //            console.log(objects);
    //            $('#SearchResult').html('');
    //            var html = "";

    //            for (var i = 0; i < objects.length; i++) {
    //                html = html + " <li><a href='" + objects[i]["Value"] + "'>" + objects[i]["Key"] + "</a></li>";

    //            }
    //            $('#SearchResult').html(html);
    //            return false;
    //            //$("#City").html(""); // clear before appending new list
    //            //$.each(cities, function (i, city) {
    //            //    $("#City").append(
    //            //        $('<option></option>').val(city.CityId).html(city.CityName));
    //            //});
    //        }
    //    });
    //});
</script>