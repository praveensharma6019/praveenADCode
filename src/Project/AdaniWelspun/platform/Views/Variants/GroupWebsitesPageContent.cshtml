@using Sitecore.XA.Foundation.MarkupDecorator.Extensions
@using Sitecore.XA.Foundation.RenderingVariants.Extensions
@using Sitecore.XA.Foundation.RenderingVariants.Fields
@using Sitecore.XA.Foundation.SitecoreExtensions.Extensions
@using Sitecore.XA.Foundation.Variants.Abstractions.Fields
@using Sitecore.Mvc
@using Sitecore.Data.Items
@using Sitecore.Data.Fields
@using Sitecore.Resources.Media
@model Sitecore.XA.Foundation.Variants.Abstractions.Models.VariantsRenderingModel

@{
    var dataSourceItem = Sitecore.Mvc.Presentation.RenderingContext.CurrentOrNull.Rendering.DataSource;
    Item groupWebsitesFolderItem = Sitecore.Context.Database.GetItem(dataSourceItem);
}
<div class="component content col-12">
    <div class="component-content">
        <div class="group-website">
            <div class="container">
                <h2 class="main-heading">Group Websites</h2>
                <div class="airport-gallry">
                    @foreach (Item groupWebsiteItem in groupWebsitesFolderItem.GetChildren())
                    {
                        string groupWebsiteUrl = string.Empty;
                        string groupWebsiteImgUrl = string.Empty;
                        string groupWebsiteCaption = groupWebsiteItem.Fields["{4F52B258-7B05-4D6C-8C96-2E2EAC46DC1B}"].Value;
                        {
                            LinkField urlField = groupWebsiteItem.Fields["{54CAB1BA-53D3-4CE4-AB7E-F8C17596AA47}"];
                            if (urlField != null && urlField.LinkType == "external")
                            {
                                groupWebsiteUrl = urlField.Url;
                            }

                            ImageField imageField = groupWebsiteItem.Fields["{EBE4FDEF-16D5-4D19-833C-24A241628A3A}"];
                            if (imageField != null && imageField.MediaItem != null)
                            {
                                groupWebsiteImgUrl = MediaManager.GetMediaUrl(imageField.MediaItem);
                            }
                        }
                        <div class="img-gal">
                            <a href="@groupWebsiteUrl" target="_blank" rel="noopener noreferrer">
                                <img src="@groupWebsiteImgUrl" alt="" />
                                <p class="field-imagecaption">@groupWebsiteCaption</p>
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
