@using Sitecore.Mvc
@using Sitecore.Mvc.Presentation
@using Sitecore.Data.Items
@model RenderingModel
@{
    Item currentItem = RenderingContext.Current.Rendering.Item;
    string imageAltText = string.Empty;    
}

@if (currentItem != null)
{
    Sitecore.Data.Fields.MultilistField otherServices = ((Sitecore.Data.Fields.MultilistField)currentItem.Fields["OtherServices"]);
    <div class="eating-section pb-0 scrollableOffset" id="@currentItem.DisplayName">
        <div class="container">
            <div class="heading-content">
                <h3 class="cm-heading">@Html.Sitecore().Field("Title", currentItem)</h3>
            </div>
            @if (otherServices != null && otherServices.GetItems().Count() > 0)
            {
                <div class="row">
                    @foreach (Sitecore.Data.Items.Item experiences in otherServices.GetItems())
                    {
                        Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)experiences.Fields["CardImage"]);
                        string imageUrl = imgField != null && imgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(imgField.MediaItem) : "";
                        if (imgField != null && imgField.MediaItem != null)
                        {
                            Sitecore.Data.Items.MediaItem image = new Sitecore.Data.Items.MediaItem(imgField.MediaItem);
                            imageAltText = image != null && image.Alt != null ? image.Alt : "";
                        }                        
                        Sitecore.Data.Fields.LinkField linkField = ((Sitecore.Data.Fields.LinkField)experiences.Fields["RedirectLink"]);
                        if (linkField != null)
                        {
                            var redirectUrl = linkField.GetFriendlyUrl();
                            <div class="col-md-6">
                                <div class="item">
                                    <a href="@redirectUrl" tabindex="0" class="zoomEffect">
                                        <figure>
                                            <img src="@imageUrl"
                                                 alt="@imageAltText" loading="lazy">
                                        </figure>
                                        <div class="content">
                                            <h3>@Html.Sitecore().Field("CardTitle", experiences)</h3>
                                            <p>
                                                @Html.Sitecore().Field("CardDescription", experiences)
                                            </p>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    }
                </div>
            }

        </div>
    </div>
}
