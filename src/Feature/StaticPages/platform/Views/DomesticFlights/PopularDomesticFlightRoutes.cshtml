@using Sitecore.Mvc
@using Sitecore.Mvc.Presentation
@using Sitecore.Data.Items
@using Adani.SuperApp.Airport.Foundation.SitecoreHelper.Platform.Helper
@model RenderingModel
@{
    Item currentItem = RenderingContext.Current.Rendering.Item;
    Item contextItem = RenderingContext.Current.ContextItem;
    var domainUrl = !string.IsNullOrEmpty(Sitecore.Configuration.Settings.GetSetting("domainUrl").ToString()) ? Sitecore.Configuration.Settings.GetSetting("domainUrl").ToString() : string.Empty;
    Sitecore.Data.Fields.MultilistField otherServices = ((Sitecore.Data.Fields.MultilistField)currentItem.Fields["OtherServices"]);
    Sitecore.Data.Fields.LinkField helpLinkField = ((Sitecore.Data.Fields.LinkField)contextItem.Fields["__Help Link"]);
    IHelper _helper = new Helper();
}

@if (currentItem != null)
{
    <div class="sectionWrapper">
        <div class="flight-routes">
            <div class="midSection">
                <h2 class="sub-heading">@Html.Sitecore().Field("Title", currentItem)</h2>
                @if (@Html.Sitecore().Field("SubTitle", currentItem) != null && @Html.Sitecore().Field("SubTitle", currentItem).ToString() != string.Empty)
                {
                    <p>@Html.Sitecore().Field("SubTitle", currentItem)</p>
                }
                @if (otherServices != null && otherServices.GetItems() != null && otherServices.GetItems().Count() > 0)
                {
                    <ul class="flights-city">
                        @foreach (Sitecore.Data.Items.Item services in otherServices.GetItems())
                        {
                            Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)services.Fields["CardImage"]);
                            string imageUrl = imgField != null && imgField.MediaItem != null ? _helper.GetImageURL(services, "CardImage") : "";
                            Sitecore.Data.Fields.LinkField linkField = ((Sitecore.Data.Fields.LinkField)services.Fields["RedirectLink"]);
                            if (linkField != null)
                            {
                                var redirectUrl = linkField.GetFriendlyUrl();
                                <li class="slide">
                                    <a href="@domainUrl@redirectUrl">
                                        <div class="city-Box zoomEffect">
                                            <figure><img src="@imageUrl" loading="lazy"></figure>
                                            <h3>@Html.Sitecore().Field("CardTitle", services)</h3>
                                            <p>@Html.Sitecore().Field("CardDescription", services)</p>
                                        </div>
                                    </a>
                                </li>
                            }
                        }

                    </ul>
                }
                <button id="loadMore" type="button" class="btn btn-outline-dark viewall-btn">
                    @Html.Sitecore().Field("__Short description", contextItem)
                </button>
            </div>
        </div>
    </div>
}
