@using Sitecore.Mvc
@{
    Sitecore.Data.Items.Item CityToCityPage = Sitecore.Context.Item;

    Sitecore.Data.Fields.ImageField imgField = ((Sitecore.Data.Fields.ImageField)CityToCityPage.Fields["Image"]);
    string bannerImageUrl = imgField != null && imgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(imgField.MediaItem) : "";

    Sitecore.Data.Fields.GroupedDroplinkField arrivalCity = ((Sitecore.Data.Fields.GroupedDroplinkField)CityToCityPage.Fields["ArrivalCity"]);
    Sitecore.Data.Fields.GroupedDroplinkField departureCity = ((Sitecore.Data.Fields.GroupedDroplinkField)CityToCityPage.Fields["DepartureCity"]);

    Sitecore.Data.Items.Item GetArrivalCity = Sitecore.Context.Database.GetItem(arrivalCity.TargetID);
    Sitecore.Data.Items.Item GetDepartureCity = Sitecore.Context.Database.GetItem(departureCity.TargetID);

    Sitecore.Data.Fields.MultilistField cityCarousalField = ((Sitecore.Data.Fields.MultilistField)GetArrivalCity.Fields["Select Card"]);
    Sitecore.Data.Fields.MultilistField depCityCarousalField = ((Sitecore.Data.Fields.MultilistField)GetDepartureCity.Fields["Select Card"]);
    Sitecore.Data.Fields.MultilistField topFlightsField = ((Sitecore.Data.Fields.MultilistField)CityToCityPage.Fields["SelectRoutes"]);
    Sitecore.Data.Fields.MultilistField faqList = ((Sitecore.Data.Fields.MultilistField)CityToCityPage.Fields["FAQList"]);

    Sitecore.Data.Fields.ImageField cityImgField = ((Sitecore.Data.Fields.ImageField)GetArrivalCity.Fields["Image"]);
    string cityImageUrl = cityImgField != null && cityImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(cityImgField.MediaItem) : "";

    Sitecore.Data.Fields.ImageField depCityImgField = ((Sitecore.Data.Fields.ImageField)GetDepartureCity.Fields["Image"]);
    string depCityImageUrl = depCityImgField != null && depCityImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(depCityImgField.MediaItem) : "";

    Sitecore.Data.Fields.ImageField depAirportImgField = ((Sitecore.Data.Fields.ImageField)GetDepartureCity.Children[0].Fields["Image"]);
    string depAirportImageUrl = depAirportImgField != null && depAirportImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(depAirportImgField.MediaItem) : "";

    Sitecore.Data.Fields.ImageField arrAirportImgField = ((Sitecore.Data.Fields.ImageField)GetArrivalCity.Children[0].Fields["Image"]);
    string arrAirportImageUrl = arrAirportImgField != null && arrAirportImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(arrAirportImgField.MediaItem) : "";


    var cardList = arrivalCity.TargetItem["Select Card"].Split('|');
    var DepcardList = departureCity.TargetItem["Select Card"].Split('|');
}

<div class="container">
    <section class="section-wrap mb-5">
        <h2 class="section-title">@CityToCityPage["Title"]</h2>
        <div>
            <img src="@bannerImageUrl"
                 width="100%"
                 class="rounded" />
        </div>
    </section>

    <div class="row">
        <div class="col-sm-12 col-md-8">
            <p class="mb-5">
                @CityToCityPage["Description"]
            </p>

            <div class="section-wrap">
                <h5>Flights from Delhi to Ahmedabad</h5>

                <table class="table flight-schedul">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">SORT BY</th>
                            <th scope="col">Departure</th>
                            <th scope="col">Arrival</th>
                            <th scope="col">Duration</th>
                            <th colspan="2">Price</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <img src="./../../assets/images/citytocity/go-first.png" loading="lazy"/>
                                <span>Go First</span>
                            </td>
                            <td>
                                <p>09:30</p>
                                <label>Delhi</label>
                            </td>
                            <td>
                                <p>11:05</p>
                                <label>Ahmedabad</label>
                            </td>
                            <td><p>1h 35m</p></td>
                            <td><p class="price">₹5,060</p></td>
                            <td class="d-none d-md-block">
                                <button class="btn btn-outline-primary">Book now</button>
                            </td>
                        </tr>

                        <tr>
                            <td>
                                <img src="./../../assets/images/citytocity/go-first.png" loading="lazy"/>
                                <span>Go First</span>
                            </td>
                            <td>
                                <p>09:30</p>
                                <label>Delhi</label>
                            </td>
                            <td>
                                <p>11:05</p>
                                <label>Ahmedabad</label>
                            </td>
                            <td><p>1h 35m</p></td>
                            <td><p class="price">₹5,060</p></td>
                            <td class="d-none d-md-block">
                                <button class="btn btn-outline-primary">Book now</button>
                            </td>
                        </tr>

                        <tr>
                            <td>
                                <img src="./../../assets/images/citytocity/go-first.png" loading="lazy"/>
                                <span>Go First</span>
                            </td>
                            <td>
                                <p>09:30</p>
                                <label>Delhi</label>
                            </td>
                            <td>
                                <p>11:05</p>
                                <label>Ahmedabad</label>
                            </td>
                            <td><p>1h 35m</p></td>
                            <td><p class="price">₹5,060</p></td>
                            <td class="d-none d-md-block">
                                <button class="btn btn-outline-primary">Book now</button>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <button type="button" class="btn btn-outline-dark viewall-btn">
                    View All
                </button>
            </div>

            <div class="section-wrap flights-info">
                <h5>Delhi to Ahmedabad Travel Flights Information</h5>

                <div class="row">
                    <div class="col-sm-12 col-md-4">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Arial Distance</p>
                                <span>945 KM </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-4">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Duration</p>
                                <span>01h 30m </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-4">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Shortest Time of flights</p>
                                <span>01h 20m  </span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-12 col-md-6">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>First Flight</p>
                                <span>IndiGo 961, departs at 4:45 am </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-6">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Last Flight</p>
                                <span>IndiGo 6E-607, departs at 10:15 pm  </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-6">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Popular Airlines</p>
                                <span>Air India, Go First, SpiceJet, IndiGo, and Vistara  </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-6">
                        <div class="flights-info__list">
                            <i class="i-gas"></i>
                            <label>
                                <p>Total flights in a week</p>
                                <span>1,134 flights  </span>
                            </label>
                        </div>
                    </div>

                    <div class="col-sm-12 col-md-6">
                        <div class="flights-info__list border-0">
                            <i class="i-gas"></i>
                            <label>
                                <p>Airport codes</p>
                                <span>Delhi-DEL, Ahmedabad-AMD  </span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <section class="section-wrap">
                <h2 class="section-title">
                    <span>@GetArrivalCity.Fields["CityName"].Value</span>
                </h2>

                <div class="airport-card">
                    <img src="@cityImageUrl"
                         width="100%"
                         class="rounded" loading="lazy"/>
                    <div class="weather-status">
                        <i class="i-gas"></i>
                        <label>Min <span>24°</span></label>
                        <label>Max <span>30°</span></label>
                    </div>
                </div>

                <div class="card border-0 airport-card">
                    <div class="row">
                        <div class="col-sm-12 col-md-8">
                            <div class="card-body">
                                <h5>@GetArrivalCity.Children[0].Fields["AirportName"].Value</h5>
                                <p class="card-text">
                                    @GetArrivalCity.Children[0].Fields["Details"].Value
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <img src="@arrAirportImageUrl"
                                 class="rounded" loading="lazy"/>
                        </div>
                    </div>
                </div>

                <div class="airport-card">
                    @Html.Raw(@GetArrivalCity.Children[0].Fields["HealthandSaftyMeasure"].Value)
                </div>

                    @Html.Sitecore().Placeholder("servicemain")
            </section>

            <section class="section-wrap">
                @Html.Raw(@GetArrivalCity.Children[0].Fields["BaggageInformation"].Value)

            <div class="airport-card">
                <h5>About @GetArrivalCity.Fields["CityName"].Value</h5>
                <p>
                    @GetArrivalCity.Fields["About"].Value
                </p>
            </div>

            <div class="airport-card">
                <h5>@GetArrivalCity.Fields["Title"]</h5>

                <div class="card-slider mb-5 slider-citytocity arrow_pos">
                    @foreach (Sitecore.Data.Items.Item item in cityCarousalField.GetItems())
                    {
                        //Sitecore.Data.Items.Item cardItem = Sitecore.Context.Database.GetItem(cardList[count]);
                        Sitecore.Data.Fields.LinkField button1 = ((Sitecore.Data.Fields.LinkField)item.Fields["HistoryURL"]);
                        Sitecore.Data.Fields.LinkField button2 = ((Sitecore.Data.Fields.LinkField)item.Fields["ArchitectureURL"]);
                        Sitecore.Data.Fields.ImageField carousalImgField = ((Sitecore.Data.Fields.ImageField)item.Fields["Image"]);
                        string carousalImageUrl = carousalImgField != null && carousalImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(carousalImgField.MediaItem) : "";

                        <div class="card">
                            <img class="card-img-top"
                                 src="@carousalImageUrl"
                                 alt="Card image cap" loading="lazy" />
                            <div class="card-body">
                                <h5 class="card-title">@item["Title"]</h5>
                            </div>
                            <div class="card-footer">
                                <a href="@button1.InternalPath" class="badge badge-pill badge-secondary">@button1.Text</a>
                                <a href="@button2.InternalPath" class="badge badge-pill badge-secondary">@button2.Text</a>
                            </div>
                        </div>
                    }
                </div>
            </div>
            </section>
            <section class="section-wrap">
                <h2 class="section-title">
                    <span>@GetDepartureCity.Fields["CityName"].Value</span>
                </h2>

                <div class="airport-card">
                    <img src="@depCityImageUrl"
                         width="100%"
                         class="rounded" loading="lazy"/>
                    <div class="weather-status">
                        <i class="i-gas"></i>
                        <label>Min <span>24°</span></label>
                        <label>Max <span>30°</span></label>
                    </div>
                </div>

                <div class="card border-0 airport-card">
                    <div class="row">
                        <div class="col-sm-12 col-md-8">
                            <div class="card-body">
                                <h5>@GetDepartureCity.Children[0].Fields["AirportName"].Value</h5>
                                <p class="card-text">
                                    @GetDepartureCity.Children[0].Fields["Details"].Value
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <img src="@depAirportImageUrl"
                                 class="rounded" loading="lazy"/>
                        </div>
                    </div>
                </div>

                <div class="airport-card">
                    <h5>About @GetDepartureCity.Fields["CityName"].Value</h5>
                    <p>
                        @GetDepartureCity.Fields["About"].Value
                    </p>
                </div>

                <div class="airport-card">
                    <h5>
                        @GetDepartureCity.Fields["Title"]
                        <label class="d-none d-md-block">@GetDepartureCity.Fields["Description"]</label>
                    </h5>

                    <div class="card-slider slider-citytocity arrow_pos">
                        @foreach (Sitecore.Data.Items.Item item in depCityCarousalField.GetItems())
                        {
                            //Sitecore.Data.Items.Item cardItem = Sitecore.Context.Database.GetItem(cardList[count]);
                            Sitecore.Data.Fields.LinkField button1 = ((Sitecore.Data.Fields.LinkField)item.Fields["HistoryURL"]);
                            Sitecore.Data.Fields.LinkField button2 = ((Sitecore.Data.Fields.LinkField)item.Fields["ArchitectureURL"]);
                            Sitecore.Data.Fields.ImageField carousalImgField = ((Sitecore.Data.Fields.ImageField)item.Fields["Image"]);
                            string carousalImageUrl = carousalImgField != null && carousalImgField.MediaItem != null ? Sitecore.Resources.Media.MediaManager.GetMediaUrl(carousalImgField.MediaItem) : "";

                            <div class="card">
                                <img class="card-img-top"
                                     src="@carousalImageUrl"
                                     alt="Card image cap" loading="lazy"/>
                                <div class="card-body">
                                    <h5 class="card-title">@item["Title"]</h5>
                                </div>
                                <div class="card-footer">
                                    <a href="@button1.InternalPath" class="badge badge-pill badge-secondary">@button1.Text</a>
                                    <a href="@button2.InternalPath" class="badge badge-pill badge-secondary">@button2.Text</a>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </section>
        </div>
        <div class="col-sm-12 col-md-4">
            <div class="section-wrap rightairport-info">
                <h5>@CityToCityPage["TopFlightsTitle"]</h5>
                @foreach (Sitecore.Data.Items.Item flight in topFlightsField.GetItems())
                {
                    <p>@flight["Title"]</p>
                }
            </div>

            <div class="section-wrap rightairport-info">
                <h5>@CityToCityPage["AirportInfoTitle"]</h5>
                <p>
                    <span>@GetDepartureCity.Fields["CityName"]</span> @GetDepartureCity.Children[0].Fields["AirportAddress"].Value
                </p>
                <p>
                    <span>@GetArrivalCity.Fields["CityName"]</span> @GetArrivalCity.Children[0].Fields["AirportAddress"].Value
                </p>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12 col-md-12">
            <h2 class="faq-title">@CityToCityPage["FAQTitle"]</h2>
            <div class="accordion" id="accordionExample">
                @foreach (Sitecore.Data.Items.Item faq in faqList.GetItems())
                {
                    <div class="accordion-item" id="@faq.ID">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed"
                                type="button"
                                data-bs-toggle="collapse"
                                data-bs-target="#@faq.Name"
                                aria-expanded="false"
                                aria-controls="#@faq.Name">
                            @faq["Question"]
                        </button>
                    </h2>
                    <div id="@faq.Name"
                         class="accordion-collapse collapse"
                         aria-labelledby="headingOne"
                         data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            @faq["Answer"]
                        </div>
                    </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

