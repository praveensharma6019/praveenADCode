@using Sitecore.Foundation.Dictionary.Extensions
@using Sitecore.Foundation.SitecoreExtensions.Extensions
@using Sitecore.Feature.Accounts
@using Sitecore.Mvc.Configuration
@using Sitecore.Feature.Accounts.SessionHelper
@using CaptchaMvc;
@using CaptchaMvc.HtmlHelpers;
@model Sitecore.Feature.Accounts.Models.ComplaintFileRegistrationModel
@{
    //var complaintPortalHomePage = (Sitecore.Context.Database.GetItem(Templates.ComplaintPortal.ComplaintPortalHelpdeskHomePage)).Url();
    var ComplaintPortalFileComplaintPage = (Sitecore.Context.Database.GetItem(Templates.ComplaintPortal.ComplaintPortalFileComplaintPage)).Url();
    var ComplaintPortalTrackComplaintPage = (Sitecore.Context.Database.GetItem(Templates.ComplaintPortal.ComplaintPortalHomePage)).Url();
    //var ComplaintPortalSubmitFeedbackPage = (Sitecore.Context.Database.GetItem(Templates.ComplaintPortal.ComplaintPortalSubmitFeedbackPage)).Url();
}
<style>
    div#gmap {
        width: 80%;
        height: 500px;
        border: double;
    }
</style>

@*<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>*@
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js'></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.10/jquery.validate.unobtrusive.min.js"></script>



<div class="contentSection account">
    <!-- Page Content -->
    <section class="section_ICRS-form pb-5">
        <div class="bg-images"><img src="/images/ICRS-BG.png"></div>
        <div class="container">
            <ul class="breadcrumb">
                <li><a href="/complaint-registration-home">Home</a></li>
            </ul>
            <h2 class="pageTitle">Complaint Registration and Tracking</h2>
        </div>
        <div class="container">
            <div class="complaint-panel p-4">
                @using (Html.BeginForm("Logout", "Accounts", FormMethod.Post))
                {
                    <div class="row mb-3">
                        <div class="col-lg-6">
                            <h3>Welcome, <span class="txt-orange">@UserSession.AEMLComplaintUserSessionContext.LoginName</span></h3>
                        </div>
                        <div class="col-lg-6">
                            <ul class="search_sidebar">
                                <li>
                                    <p class="user_logout">
                                        <button class="" type="submit">
                                            @Html.Sitecore().Dictionary("/ComplaintRegistration/Logout", "Logout")
                                            <span class="fa fa-sign-out-alt mr-2"></span>
                                        </button>
                                    </p>

                                </li>
                            </ul>
                        </div>
                    </div>
                }

                @if (!Model.IsRegistered)
                {
                    <div class="container">
                        @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { id = "frmComplaintRegistration", @class = "form-signin", @enctype = "multipart/form-data" }))
                        {
                            @Html.AddUniqueFormId()
                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true)
                            @Html.HiddenFor(x => x.LoginName)
                            @Html.HiddenFor(x => x.ComplaintId)
                            @Html.HiddenFor(m => m.AccountNumber)
                            @Html.HiddenFor(m => m.Address)
                            @Html.HiddenFor(m => m.EmailId)
                            @Html.HiddenFor(m => m.MobileNumber)
                            @Html.HiddenFor(m => m.ConsumerName)
                            <div class="">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <p class="text-note mb-2">At Adani electricity we remain committed to offering the best experience to you. While we deeply regret the inconvenience caused to you, we assure you that your complaints shall be promptly attended to and resolved satisfactorily at the earliest.</p>
                                    </div>
                                </div>
                                <div>
                                    <div class="row mt-3">
                                        @if (!string.IsNullOrEmpty(Model.ComplaintId) && !string.IsNullOrEmpty(Model.ComplaintRegistrationNumber))
                                        {
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Complaint Registration Number</b></label>
                                                    @Html.TextBoxFor(x => x.ComplaintRegistrationNumber, new { @class = "form-control", @readonly = "readonly" })
                                                </div>
                                            </div>
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Complaint Status</b></label>
                                                    @Html.TextBoxFor(x => x.ComplaintStatusDescription, new { @class = "form-control", @readonly = "readonly" })
                                                </div>
                                            </div>
                                        }
                                        <div class="col-lg-6 col-md-6">
                                            <div class="form-group">
                                                <label for=""><b>Complaint Category</b></label>
                                                @Html.DropDownListFor(x => x.SelectedComplaintCategory, new SelectList(Model.ComplaintCategorySelectList, "Value", "Text", Model.SelectedComplaintCategory), "Select", new { @class = "form-control", id = "ddlComplaintCategory", required = "required" })
                                                @Html.ValidationMessageFor(x => x.SelectedComplaintCategory, "", new { @class = "help-block" }, "p")
                                            </div>
                                        </div>
                                        @if (Model.SelectedComplaintCategory == "3" || Model.SelectedComplaintCategory == "4" || Model.SelectedComplaintCategory == "5" || Model.SelectedComplaintCategory == "6")
                                        {
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Complaint Sub-Category</b></label>
                                                    @Html.DropDownListFor(x => x.SelectedComplaintSubCategory, new SelectList(Model.ComplaintSubCategorySelectList, "Value", "Text", Model.SelectedComplaintSubCategory), new { @class = "form-control", id = "ddlComplaintSubCategory", required = "required" })
                                                    @Html.ValidationMessageFor(x => x.SelectedComplaintSubCategory, "", new { @class = "help-block" }, "p")
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Complaint Sub-Category</b></label>
                                                    @Html.DropDownListFor(x => x.SelectedComplaintSubCategory, new SelectList(Model.ComplaintSubCategorySelectList, "Value", "Text", Model.SelectedComplaintSubCategory), "Select", new { @class = "form-control", id = "ddlComplaintSubCategory", required = "required" })
                                                    @Html.ValidationMessageFor(x => x.SelectedComplaintSubCategory, "", new { @class = "help-block" }, "p")
                                                </div>
                                            </div>
                                        }
                                    </div>
                                    @if (Model.SelectedComplaintCategory == "2" && (Model.SelectedComplaintSubCategory == "4" || Model.SelectedComplaintSubCategory == "5"))
                                    {
                                        <div class="row" id="complaintFileUploadSection">
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Transaction Receipt</b></label>
                                                    @*@Html.TextBoxFor(model => model.TransactionReceipt, "", new { id = "TransactionReceipt", @type = "file", @class = "w-100 bg-white p-1", @onchange = "ValidateFile(this);", @accept = ".jpg,.jpeg,.png,.pdf" })
                                                        @Html.ValidationMessageFor(model => model.TransactionReceipt, "", new { @class = "text-danger" })*@
                                                    <input type="file" id="fileTransactionReceipt" onchange="ValidateFile(this);" name="fileTransactionReceipt" class="help-block w-100" />
                                                    @*<p style="font-size:12px;">(Please upload file in jpg format only)</p>*@
                                                    @*<p class="text-danger" id="TransactionReceiptMessage"></p>*@
                                                    @Html.ValidationMessageFor(model => model.TransactionReceipt, "", new { @class = "" })
                                                </div>
                                            </div>
                                            <div class="col-lg-6 col-md-6">
                                                <div class="form-group">
                                                    <label for=""><b>Bank Account Statement</b></label>
                                                    @*@Html.TextBoxFor(model => model.BankAccountStatement, "", new { id = "BankAccountStatement", @type = "file", @class = "w-100 bg-white p-1", @onchange = "ValidateFile(this);", @accept = ".jpg,.jpeg,.png,.pdf" })
                                                        @Html.ValidationMessageFor(model => model.BankAccountStatement, "", new { @class = "text-danger" })*@
                                                    <input type="file" id="fileBankAccountStatement" onchange="ValidateFile(this);" name="fileBankAccountStatement" class="help-block w-100" />
                                                    @*<p style="font-size:12px;">(Please upload file in jpg format only)</p>*@
                                                    @*<p class="text-danger" id="BankAccountStatementMessage"></p>*@
                                                    @Html.ValidationMessageFor(model => model.BankAccountStatement, "", new { @class = "" })
                                                </div>
                                            </div>
                                        </div>
                                    }

                                    <div class="row">
                                        <div class="col-lg-12 col-md-12">
                                            <div class="form-group">
                                                <label for=""><b>Complaint Description</b></label>
                                                @Html.TextAreaFor(x => x.ComplaintDescription, new { maxlength = 120, @class = "form-control" })
                                                @Html.ValidationMessageFor(x => x.ComplaintDescription, "", new { @class = "" }, "p")
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group">
                                                <input type="checkbox" name="termsCb" class="" id="termsCb">
                                                <label class="" for="termsCb">I agree to receive notification, alert, and status of complaint on Mobile and Email.</label>
                                                <p class="txt-orange" id="docErrorMessage"></p>
                                            </div>
                                        </div>

                                        <div class="col-lg-12">
                                            <div class="form-group py-2 mb-0">
                                                <input type="submit" class="btn btn-primary mb-2 mb-md-0" name="SubmitApplication" id="SubmitApplication" value="Submit Application" />
                                                <a href="@ComplaintPortalTrackComplaintPage" class="btn btn-secondary mb-2 mb-md-0">Cancel</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                        <div class="text-right"><a href="@ComplaintPortalTrackComplaintPage" class="goBack"><i class="fas fa-arrow-left txt-orange"></i>&nbsp;&nbsp;Go back</a></div>
                    </div>
                }
                else
                {
                    <div class="container">
                        @using (Html.BeginRouteForm(MvcSettings.SitecoreRouteName, FormMethod.Post, new { id = "frmComplaintRegistration", @class = "form-signin", @enctype = "multipart/form-data" }))
                        {
                            @Html.AddUniqueFormId()
                            @Html.AntiForgeryToken()
                            @Html.ValidationSummary(true)
                            @Html.HiddenFor(x => x.LoginName)
                            @Html.HiddenFor(x => x.ComplaintId)
                            @Html.HiddenFor(m => m.AccountNumber)
                            @Html.HiddenFor(m => m.Address)
                            @Html.HiddenFor(m => m.EmailId)
                            @Html.HiddenFor(m => m.MobileNumber)
                            @Html.HiddenFor(m => m.ConsumerName)
                            @Html.HiddenFor(m => m.IsRegistered)
                            <div class="">
                                <div class="row">
                                    <div class="col-lg-3 text-lg-left text-center pb-4">
                                        <img src="/images/ICRS/complaint-thumb.png" class="img-fluid">
                                    </div>
                                    <div class="col-lg-8">
                                        <div class="py-lg-4 py-3">
                                            <h3 class="mb-2 txt-black">Your Complaint has been registered and your complaint number is</h3>
                                            <p class="mb-2 txt-orange txt-md"><b>@Model.ComplaintId</b></p>
                                            <p class="mb-3 text-light-g">Please use the complaint number for all future corespondence with AEML</p>
                                        </div>
                                    </div>
                                </div>
                                @if (!Model.IsReadyToShareFeedback)
                                {
                                    <div class="bg-light-orange">
                                        <div class="row">
                                            <div class="col-lg-8">
                                                <div class="p-lg-4 p-3">
                                                    <h2 class="mb-4 txt-md"><b>Would you like to spent some time for sharing your feedback, it will not take much time.</b></h2>
                                                    <h2 class="mb-5 txt-md"><b></b></h2>
                                                    <p>
                                                        <input type="submit" class="btn btn-feedback-y mr-2" id="SubmitFeedbackYes" name="SubmitFeedbackYes" value="Yes" />
                                                        <input type="submit" class="btn btn-feedback-n" id="SubmitFeedbackNo" name="SubmitFeedbackNo" value="No" />
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="col-lg-3">
                                                <div class="text-lg-right text-center">
                                                    <img src="/images/ICRS/feedback_thumb.png" class="img-fluid">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="form-panel mx-0">
                                        <div class="row">
                                            <div class="col-lg-5">
                                                <div class="bg-cream">
                                                    <span class="sub-text">Please rate your experience on the following</span>
                                                    <p>How would you rate your experience of registering the query/concern?</p>
                                                </div>
                                            </div>
                                            <div class="col-lg-7">
                                                <div id="exp_call-center" class="rating_section">
                                                    @foreach (var r in Model.ConcernRating)
                                                    {
                                                        <div>
                                                            @Html.Label(r.RatingName)
                                                            @Html.RadioButtonFor(m => m.ConcernAddressed, r.RatingValue, new { @class = r.RatingClass + " ConcernAddressed" })
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                            <div class="col-lg-11 mx-auto"><hr></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-5">
                                                <div class="bg-cream">
                                                    <p>How would you rate your overall experience of using portal?</p>
                                                </div>
                                            </div>
                                            <div class="col-lg-7">
                                                <div id="exp_call-center" class="rating_section">
                                                    @foreach (var r in Model.Rating)
                                                    {
                                                        <div>
                                                            @Html.Label(r.RatingName)
                                                            @Html.RadioButtonFor(m => m.OverallExperience, r.RatingValue, new { @class = r.RatingClass + " OverallExperience" })
                                                        </div>
                                                    }
                                                </div>
                                            </div>
                                            <div class="col-lg-11 mx-auto"><hr></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-5">
                                                <div class="bg-cream">
                                                    <p>Remarks (If any)</p>
                                                </div>
                                            </div>
                                            <div class="col-lg-7">
                                                <div class="form-group py-4 mr-lg-5 mr-3">
                                                    @Html.TextAreaFor(M => M.FeedbackRemarks, new { @class = "form-control", @rows = "2" })
                                                </div>
                                            </div>
                                            <div class="col-lg-11 mx-auto"><hr></div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-5">
                                                <div class="bg-cream p-lg-3 p-0">
                                                </div>
                                            </div>
                                            <div class="col-lg-7">
                                                <div class="form-group py-4 mr-lg-5 mr-3 text-right">
                                                    <div class="row">
                                                        <div class="col-sm-6">
                                                            <input type="submit" class="btn btn-primary" id="SubmitFeedback" name="SubmitFeedback" value="Submit" />
                                                            <input type="submit" class="btn btn-secondary" id="SubmitFeedbackCancel" name="SubmitFeedbackCancel" value="Cancel" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </div>
                        }
                    </div>
                }
            </div>
        </div>
    </section>
    <!-- /Page Content -->
</div>

<div id="message_modal" class="modal fade show" role="dialog" style="display: none; padding-right: 17px;" data-id="">
    <div class="modal-dialog modal-dialog-centered">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <p>Message</p>
                <button type="button" class="close" data-dismiss="modal">X</button>
            </div>
            <div class="modal-body">
                @if (Session["Message"] != null && !string.IsNullOrEmpty(Session["Message"].ToString()))
                {
                    <div class="form-group row">
                        <label for="" class="col-sm-12 col-form-label txt-green">@Session["Message"].ToString()</label>
                        @*@if (Session["AlertMessage"] != null && !string.IsNullOrEmpty(Session["AlertMessage"].ToString()))
                            {
                                <p class="col-sm-12 col-form-label txt-orange">@Session["AlertMessage"].ToString()</p>
                            }*@
                    </div>
                    Session["Message"] = null;
                    Session["AlertMessage"] = null;
                }
            </div>
            <button type="button" style="padding-bottom:10px;" class="close" data-dismiss="modal">Ok</button>
        </div>
    </div>
</div>
